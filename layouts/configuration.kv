#:import FallOutTransition kivy.uix.screenmanager.FallOutTransition


<ConfigurationScreen>
    sm: app.screen_manager
    GradientBackground:
        orientation: "vertical"
        padding: 10
        width: root.width
        height: root.height

        BoxLayout:
            size_hint: None, None
            height: 80
            padding: 20
            width: root.width - 20
            orientation: "horizontal"
            halign: "right"
            spacing: 10
            Widget
            Button:
                id: menu_button
                background_color: (0, 0, 0, 0)
                size_hint: None, None
                size: 40, 40
                on_release:
                    root.manager.transition = FallOutTransition()
                    root.manager.current = "search"
                Image:
                    source: "images/navigation/back.png"
                    size_hint: None, None
                    size: 40, 40
                    x: self.parent.x
                    y: self.parent.y
            Button:
                id: close_button
                background_color: (0, 0, 0, 0)
                size_hint: None, None
                size: 40, 40
                on_release: app.stop()
                Image:
                    source: "images/navigation/close.png"
                    size_hint: None, None
                    size: 40, 40
                    x: self.parent.x
                    y: self.parent.y
        ScrollView:
            bar_width: 6
            bar_inactive_color: 1, 1, 1, 0.2
            bar_color: 1, 1, 1, 0.75
            GridLayout:
                cols: 1
                padding: 100, 60
                size_hint: None, None
                width: root.width - 20
                height: self.minimum_height
                spacing: 60
                Label:
                    text: "Configuration"
                    font_size: 48
                    size_hint_y: None
                    height: "48dp"
                    text_size: self.width, None
                    halign: "center"
                GridLayout:
                    cols: 1
                    spacing: 20
                    height: self.minimum_height
                    size_hint_y: None
                    Label:
                        text: "Format"
                        font_size: 36
                        size_hint_y: None
                        height: "36dp"
                        text_size: self.width, None
                        halign: "center"
                    GridLayout:
                        cols: 2
                        height: self.minimum_height
                        size_hint_y: None
                        spacing: 20
                        Label:
                            text: "time:"
                            font_size: 28
                            size_hint_y: None
                            text_size: self.width, self.height
                            height: 50
                            halign: "right"
                            valign: "center"
                        GridLayout:
                            cols: 2
                            height: self.minimum_height
                            ToggleButton:
                                id: toggle_time_24
                                text: "24 hours"
                                group: "time_toggle"
                                size_hint: None, None,
                                width: 100
                                height: 50
                                allow_no_selection: False
                                color: app.bg_end
                                background_normal: ""
                                background_down: ""
                                background_color: (1,1,1,0.25) if self.state == 'normal' else (1,1,1,0.75)
                            ToggleButton:
                                id: toggle_time_12
                                text: "12 hours"
                                group: "time_toggle"
                                size_hint: None, None,
                                color: app.bg_end
                                width: 100
                                height: 50
                                allow_no_selection: False
                                background_normal: ""
                                background_down: ""
                                background_color: (1,1,1,0.25) if self.state == 'normal' else (1,1,1,0.75)
                    GridLayout:
                        cols: 2
                        height: self.minimum_height
                        size_hint_y: None
                        spacing: 20
                        Label:
                            text: "temperature:"
                            font_size: 28
                            size_hint_y: None
                            text_size: self.width, self.height
                            height: 50
                            halign: "right"
                            valign: "center"
                        GridLayout:
                            height: self.minimum_height
                            cols: 2
                            ToggleButton:
                                id: toggle_temp_cels
                                text: "Celsius"
                                group: "temperature_toggle"
                                size_hint: None, None,
                                width: 100
                                height: 50
                                allow_no_selection: False
                                color: app.bg_end
                                background_normal: ""
                                background_down: ""
                                background_color: (1,1,1,0.25) if self.state == 'normal' else (1,1,1,0.75)

                            ToggleButton:
                                id: toggle_temp_fahr
                                text: "Fahrenheit"
                                group: "temperature_toggle"
                                size_hint: None, None,
                                color: app.bg_end
                                width: 100
                                height: 50
                                allow_no_selection: False
                                background_normal: ""
                                background_down: ""
                                background_color: (1,1,1,0.25) if self.state == 'normal' else (1,1,1,0.75)
                    Label:
                        text: "Select time or temperature display units."
                        font_size: 24
                        height: "24dp"
                        size_hint_y: None
                        text_size: self.width, None
                        halign: "justify"
                        color: 1, 1, 1, 0.75


                GridLayout:
                    cols: 1
                    spacing: 20
                    height: self.minimum_height
                    size_hint_y: None
                    Label:
                        text: "APIs"
                        font_size: 36
                        size_hint_y: None
                        height: "36dp"
                        text_size: self.width, None
                        halign: "center"
                    GridLayout:
                        cols: 2
                        height: self.minimum_height
                        size_hint_y: None
                        spacing: 20
                        Label:
                            text: "geolocation:"
                            font_size: 28
                            size_hint_y: None
                            text_size: self.width, self.height
                            height: 50
                            halign: "right"
                            valign: "center"
                        APISpinner:
                            id: api_geo_selection
                            size_hint: None, None,
                            color: app.bg_end
                            font_size: 20
                            width: 300
                            height: 50
                            background_normal: ""
                            background_down: ""
                            background_color: (1,1,1,0.6)
                    GridLayout:
                        cols: 2
                        height: self.minimum_height
                        size_hint_y: None
                        spacing: 20
                        Label:
                            text: "weather:"
                            font_size: 28
                            size_hint_y: None
                            text_size: self.width, self.height
                            height: 50
                            halign: "right"
                            valign: "center"
                        APISpinner:
                            id: api_weather_selection
                            size_hint: None, None,
                            color: app.bg_end
                            font_size: 20
                            width: 300
                            height: 50
                            background_normal: ""
                            background_down: ""
                            background_color: (1,1,1,0.6)
                    GridLayout:
                        cols: 2
                        height: self.minimum_height
                        size_hint_y: None
                        spacing: 20
                        Label:
                            text: "sunrise/sunset:"
                            font_size: 28
                            size_hint_y: None
                            text_size: self.width, self.height
                            height: 50
                            halign: "right"
                            valign: "center"
                        APISpinner:
                            id: api_sun_selection
                            size_hint: None, None,
                            color: app.bg_end
                            font_size: 20
                            width: 300
                            height: 50
                            background_normal: ""
                            background_down: ""
                            background_color: (1,1,1,0.6)
                    Label:
                        text: "Select from different weather, city geolocation and sunset/sunrise apis. Note: some api require keys and have limited daily access and some are not compatible with each other."
                        font_size: 24
                        size_hint_y: None
                        text_size: self.width, None
                        halign: "justify"
                        color: 1, 1, 1, 0.75

                GridLayout:
                    cols: 1
                    spacing: 20
                    padding: 0, 0, 0, 30
                    height: self.minimum_height
                    size_hint_y: None
                    Label:
                        text: "Preferred city"
                        font_size: 36
                        size_hint_y: None
                        height: "36dp"
                        text_size: self.width, None
                        halign: "center"
                    GridLayout:
                        cols: 2
                        height: self.minimum_height
                        size_hint_y: None
                        spacing: 20
                        GridLayout:
                            cols: 2
                            height: self.minimum_height
                            width: self.minimum_width
                            size_hint: None, None

                            ToggleButton:
                                id: auto_city_on_toggle
                                text: "On"
                                group: "auto_city_toggle"
                                size_hint: None, None,
                                width: 100
                                height: 50
                                allow_no_selection: False
                                color: app.bg_end
                                background_normal: ""
                                background_down: ""
                                background_color: (1,1,1,0.25) if self.state == 'normal' else (1,1,1,0.75)

                            ToggleButton:
                                id: auto_city_off_toggle
                                text: "Off"
                                group: "auto_city_toggle"
                                size_hint: None, None,
                                color: app.bg_end
                                width: 100
                                height: 50
                                allow_no_selection: False
                                background_normal: ""
                                background_down: ""
                                background_color: (1,1,1,0.25) if self.state == 'normal' else (1,1,1,0.75)
                        TextInput:
                            id: auto_city_input
                            size_hint: None, None
                            font_size: 24
                            padding: 10, 10
                            width: 360
                            height: 50
                            text_size: self.size
                            multiline: False
                            hint_text: "Enter name"
                            hint_text_color: get_color_from_hex(app.bg_start)
                            background_normal: "white.png"
                            background_active: "white.png"
                            selection_color: get_color_from_hex(app.bg_start + "88")
                            background_color: 1,1,1,0.75
                            foreground_color: get_color_from_hex(app.bg_end)
                            cursor_color: get_color_from_hex(app.bg_end)


                    Label:
                        text: "If selected the weather app will not ask a location in advance. The weather of the specified location in the entry will be show instead."
                        font_size: 24
                        size_hint_y: None
                        text_size: self.width, None
                        halign: "justify"
                        color: 1, 1, 1, 0.75

                AnchorLayout:
                    Button:
                        id: save_configuration_button
                        text: "Save"
                        size_hint: None, None,
                        color: app.bg_end
                        font_size: 32
                        width: 300
                        height: 60
                        halign: "center"
                        background_normal: ""
                        background_down: ""
                        background_color: (1,1,1,0.6)
                        on_release:
                            root.manager.transition.direction = "right"
                            # TODO
                            root.manager.current = root.manager.previous()